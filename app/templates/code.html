{% extends 'layout.html' %}

{% block body %}
  <style>
    .CodeMirror {
      font-family: Courier, monospace;
      font-size: 16px;
      border: 1px solid;
      border-color: #d9d9d9;
    }
  </style>

  <div class="card">
    <div class="card-body">
      <div id="editor"></div>
      <textarea id="console" class="form-control mt-2" rows=5 placeholder="Press Ctrl+Shift+Enter to execute the above code..."></textarea>
    </div>
  </div>
  
  <script type="text/javascript">
    var editor = CodeMirror(document.getElementById('editor'), {
      mode:  "python",
      lineNumbers: true,
      matchBrackets: true,
      indentUnit: 4
    });
    
    editor.setSize(null, 400);

    function execute() {
      $('#console').text('Executing...')
      $.getJSON('/execute', {source: editor.getValue()}, (data) => {
        $('#console').text(data.output)
      });
    }
    
    // Execute code on Ctrl+Shift+Enter
    var map = {17: false, 16: false, 13: false};
    
    $(document).keydown(function(event) {
      if (event.keyCode in map) {
        map[event.keyCode] = true;
        
        if (map[17] && map[16] && map[13]) {
          execute();
        }
      }
    }).keyup(function(event) {
        if (event.keyCode in map) {
          map[event.keyCode] = false;
        }
    });
    
  </script>
{% endblock %}




